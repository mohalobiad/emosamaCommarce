!function(){const u=[];new PerformanceObserver(e=>{for(const t of e.getEntries())"largest-contentful-paint"===t.entryType&&u.push(t)}).observe({type:"largest-contentful-paint",buffered:!0}),window.addEventListener("load",()=>{const l=document.querySelector(".wd-lcp-loader");if(!l||0===u.length)return;l.classList.add("wd-loading");setTimeout(()=>{l.classList.remove("wd-loading");if(0===u.length)return;let t=null;let o="";let e=!1;let r="";let n="";var a=document.body.className.split(/\s+/);var i=u[u.length-1];const s=i.element;const c=document.querySelector(".wd-lcp-admin-bar");const d=c.querySelector(".wd-loader-overlay");a.forEach(function(e){e=e.match(/(?:page-id|postid)-(\d+)/);e&&(t=parseInt(e[1],10))});if(!t)return;["IMG","PICTURE"].includes(s.tagName)?(o=s.currentSrc||s.src,r="image",e="high"===s.getAttribute("fetchpriority")):(i=getComputedStyle(s).backgroundImage)&&i.includes("url")&&(a=i.match(/url\(["']?(.*?)["']?\)/))&&(o=a[1],r="background");o?(s.classList.add("wd-lcp-highlight"),s.scrollIntoView({behavior:"smooth",block:"center"}),i=document.createElement("div"),(a=document.createElement("img")).src=o,i.appendChild(a),i.className="wd-lcp-thumb",c.querySelector(".wd-lcp-content").prepend(i),e?(n=woodmart_settings.lcp_image_with_fetchpriority,o=""):n=woodmart_settings.lcp_image_confirmed):n=woodmart_settings.lcp_without_image_confirmed;m(n,!1,o).then(e=>{if(!e)return s.classList.remove("wd-lcp-highlight"),e=window.location.origin+window.location.pathname,window.history.replaceState({},document.title,e),c.classList.remove("wd-opened"),void c.classList.remove("hover");d.classList.add("wd-loading");e=new URLSearchParams(window.location.search);e=e.get("security");jQuery.ajax({url:woodmart_settings.ajaxurl,data:{action:"woodmart_update_lcp_image",image_url:o,image_type:r,post_id:t,security:e,device:768<=woodmartThemeModule.windowWidth?"desktop":"mobile"},dataType:"json",method:"GET",success:function(e){e.hasOwnProperty("data")&&(c.classList.add("wd-saved"),m(e.data.message,!0))},error:function(){console.error("Something wrong with AJAX response.")},complete:function(){var e=window.location.origin+window.location.pathname,e=(window.history.replaceState({},document.title,e),Array.from(c.children).filter(e=>e.classList&&e.classList.contains("ab-item"))[0]);e&&(e.remove(),(e=document.createElement("div")).className="ab-item ab-empty-item",e.setAttribute("role","menuitem"),e.setAttribute("aria-expanded","false"),e.textContent="LCP Image",c.prepend(e)),d.classList.remove("wd-loading"),s.classList.remove("wd-lcp-highlight"),c.querySelector(".wd-done").addEventListener("click",e=>{e.preventDefault();location.reload();c.classList.remove("wd-saved");c.classList.remove("wd-opened");c.classList.remove("hover")})}})})},2500);function m(d="",l=!1,m=!0){return new Promise(t=>{var e=document.querySelector(".wd-lcp-admin-bar");var o=e.querySelector(".wd-lcp-desc");const r=e.querySelector(".wd-confirm");const n=e.querySelector(".wd-cancel");var a=e.querySelector(".wd-done");d&&(o.textContent=d);e.classList.add("wd-opened");!l&&(m||l||woodmart_settings.lcp_has_image)||(r.classList.add("wd-hide"),n.classList.add("wd-hide"),a.classList.remove("wd-hide"));m||l||woodmart_settings.lcp_has_image||a.addEventListener("click",c);function i(){r.removeEventListener("click",s),n.removeEventListener("click",c)}function s(e){e.preventDefault(),i(),t(!0)}function c(e){e.preventDefault(),i(),t(!1)}r.addEventListener("click",s);n.addEventListener("click",c)})}})}();